# HTTP server
PORT=3001
LOG_LEVEL=info
LOG_PRETTY=true

# Postgres settings (inject credentials via env/secret store)
DB_HOST=db
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=
DB_NAME=mini_derms

# MQTT broker settings
MQTT_HOST=mosquitto
MQTT_PORT=1883
MQTT_USERNAME=
MQTT_PASSWORD=
MQTT_TLS_ENABLED=false
MQTT_TLS_CA_PATH=/run/secrets/mqtt-ca.pem
MQTT_TLS_CERT_PATH=/run/secrets/mqtt-client-cert.pem
MQTT_TLS_KEY_PATH=/run/secrets/mqtt-client-key.pem
MQTT_TLS_REJECT_UNAUTHORIZED=true
MQTT_MAX_PAYLOAD_BYTES=262144
MQTT_PROCESSING_TIMEOUT_MS=3000

# Telemetry ingest (queue/batching; tune for higher throughput)
TELEMETRY_BATCH_SIZE=25
TELEMETRY_BATCH_FLUSH_MS=100
TELEMETRY_MAX_QUEUE_SIZE=2000

# TLS (optional)
TLS_ENABLED=false
TLS_KEY_PATH=/run/secrets/server-key.pem
TLS_CERT_PATH=/run/secrets/server-cert.pem

# Observability
PROMETHEUS_ENABLED=true
PROMETHEUS_PATH=/metrics

# Control loop behavior
CONTROL_INTERVAL_SECONDS=60
FEEDER_DEFAULT_LIMIT_KW=250

# Auth (secrets must be injected from a vault or env variables)
# Use 32+ character secrets and rotate at least every 90 days.
# Do not deploy with the sample JWT_SECRET below; override it in real environments.
JWT_SECRET=d141924884297a46ee149d98048d5a0f11725297fba0c0b709ee44306d1f0ac8
JWT_TOKEN_TTL_HOURS=12
JWT_CLOCK_TOLERANCE_SECONDS=60
AUTH_USERS=[{"username":"admin","passwordHash":"scrypt:xLh0jB75AaU76rkvzo6lQQ==:hYlm2cAHnEsPIOBqLtEkkLw+5sqqp65+hGdd7G5JsMYpuxphfH4waWJGO7OXqkkKYxV//BFqIlSomNBBW2y2Gg==","role":"admin"},{"username":"operator","passwordHash":"scrypt:/ZSPTYQIurOQ9HDzhFjARg==:40qROaCMgsp2YnZEtWxHxGi6U2R9XM32nqRbevEYACh6Whrl+BRsiz3fYgUYhWirtWUmKONfn5sxBxm1QcRNOQ==","role":"operator"},{"username":"viewer","passwordHash":"scrypt:Klf58UloD5s4RWjAAWRMRg==:jbf1FS/JO1XIydqzNxsR9WnNfTsweGyegtiN9iO400KKpcPn48VCYDGjOqqFEIjtKuiP6ubG88Q5+9gmJK66Pg==","role":"viewer"}]
# Provide AUTH_USERS as a JSON array with passwordHash (scrypt) values. Generate hashes with `npm run auth:hash <password>` and inject them via vault/secret manager.
# Example (local dev only, passwords Adm1n!2345678 / Op3rator!23456 / View3r!23456):
# AUTH_USERS='[{"username":"admin","passwordHash":"scrypt:xLh0jB75AaU76rkvzo6lQQ==:hYlm2cAHnEsPIOBqLtEkkLw+5sqqp65+hGdd7G5JsMYpuxphfH4waWJGO7OXqkkKYxV//BFqIlSomNBBW2y2Gg==","role":"admin"},{"username":"operator","passwordHash":"scrypt:/ZSPTYQIurOQ9HDzhFjARg==:40qROaCMgsp2YnZEtWxHxGi6U2R9XM32nqRbevEYACh6Whrl+BRsiz3fYgUYhWirtWUmKONfn5sxBxm1QcRNOQ==","role":"operator"},{"username":"viewer","passwordHash":"scrypt:Klf58UloD5s4RWjAAWRMRg==:jbf1FS/JO1XIydqzNxsR9WnNfTsweGyegtiN9iO400KKpcPn48VCYDGjOqqFEIjtKuiP6ubG88Q5+9gmJK66Pg==","role":"viewer"}]'
